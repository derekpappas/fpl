//testing fifo with rf
//andreim
//11 oct 2007

csl_register_file rf_a{
   rf_a(){
      set_width ( 4 );
      set_depth ( 8 );
   }
};

csl_fifo fifo_a{
   fifo_a(){
     set_depth ( 8 );
     set_width ( 4 );
     set_physical_implementation( ffa );
     add_logic ( sync_fifo );
   }
};

csl_unit unit_add{
   csl_port clk(input);
   //fifo_a fifo_a_i;
   unit_add(){
      clk.set_attr( clock );
   }
};

csl_unit top_unit{
  //csl_port stim_p( input  );
  // csl_port exp_p ( output );
   csl_port p1(input);
   csl_port p2(input);
   csl_port p3(input);                  
   csl_port p4(input,3);
   csl_port p5(input,3);
   csl_port p6(input,3);
   csl_port p7(input,4);
   csl_port p8(output,4);
   csl_port p9(output,4);
   csl_port p10(input);
   csl_port p11(input);
   csl_port p12(input);
   csl_port p13(output);
   csl_port p14(output);
   csl_port p15(output,4);
   rf_a rf_a_i(.reset(p1),.clear(p2),.clock(p3),.wr_addr(p4),.rd_addr0(p5),.rd_addr1(p6),.data_in(p7),.data_out0(p8),.data_out1(p9),.wr_en(p10),.rd_en0(p11),.rd_en1(p12),.valid(p13));
   fifo_a ff(.push(p1),.pop(p2),.full(p13),.empty(p14),.rd_data(p15),.wr_data(p7),.reset_(p10),.clock(clk),.valid(p13));
   csl_port clk(input);
   unit_add unit_add_i(.clk( clk ));
   top_unit(){
      clk.set_attr( clock );
   }
};


csl_vector stim_vec{
   stim_vec(){
      set_unit_name( top_unit);
      set_direction  ( input   );
   }
};

csl_vector exp_vec{
   exp_vec(){
       set_unit_name( top_unit);
       set_direction  ( output  );
   }
};

csl_testbench tb{
   top_unit top_unit_i;
   csl_signal clk(reg);
   tb(){
     clk.set_attr(clock);
     add_logic(clock,clk,2, ns);
   }
};
