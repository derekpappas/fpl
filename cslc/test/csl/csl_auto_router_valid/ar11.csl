// Author: cghaba
// Date: April 3, 2008

/*
                +------------------------------------------------------------------+
                |    +---------------------------------------------------------+   |
                |    |                                                         |   |
                |    |             +---------------------------+               |   |
                |    |+-----------+|         +-----------+     |  +---------+  |   |
                |    || +-------+ ||         | +-------+ |     |  |+-------+|  |   |
                |    || |       | ||         | |       | |     |  ||       ||  |   |
                |    ++-+       +-++  +------+-+       +-+---+ +--++       ++--+   |
                |     | |  bu   | |   |      | |  bu   | |   |    ||  bu   ||      |
                |     | |       | |   |      | |       | |   |    ||       ||      |
             ---+-----+-+       +-+---|    +-+-+       +-+-| | +--++       ++--+   |
                |     | |       | |        | | |       | | | | |  ||       ||  |   |
                |     | +-------+ |        | | +-------+ | | | |  |+-------+|  |   |
                |     |           |        | |           | | | |  |         |  |   |
                |     |           |        +-+-----------+-+----------------+--+   |
                |     |           |          |           | | | |  |         |      |
                |  +--+-----------+------------------------+ | |  |         |      |
                |  |  |           |          |           |   | |  |         |      |
                |  |  | +-------+ |          | +-------+ |   | |  |+-------+|      |
                |  |  | |       | |          | |       | |   | |  ||       ||      |
                |  +--+-+  su   +-+----------+-+   su  +-+---|-+  ||  su   ++------+---
                |     | |       | |          | |       | |   +----++       ||      |
                |     | +-------+ |          | +-------+ |        |+-------+|      |
                |     +-----------+          +-----------+        +---------+      |
                |top        u0                     u1                  u2          |
                +------------------------------------------------------------------ 

*/


// defining constants 

/*csl_enum e_const{
  DATA_WIDTH=16,
    SEL_WIDTH=3,         // to be used in other versions
    DOUBLE_DATA_WIDTH=32 // to be used in other versions
    };*/

// define bitranges

csl_bitrange br_d(16);                     
csl_bitrange br_s(3);                      // to be used in other versions
csl_bitrange br_dd(32);             // to be used in other versions
csl_bitrange br_lw(0,15);                // to be used in other versions
csl_bitrange br_hw(16,31);// to be used in other versions

// define interfaces
/*csl_interface ifcresclk{
  csl_port reset(input);
  csl_port clock(input);
  ifcresclk(){
  }
};*/

// interface for small unit
csl_interface ifc_su{
  csl_port iin(input,br_d);
  csl_port iout(output,br_d);
  ifc_su(){
  }
};

// interface for big unit
csl_interface ifc_bu{
  ifc_su ifcup;
  ifc_su ifcdw;
  ifc_bu(){
  }
};

// small unit
csl_unit usu{
// csl_port reset(input);
//  csl_port clock(input);
  ifc_su ifcsu0;

  usu(){
  }
};

// big unit
csl_unit ubu{
// csl_port reset(input);
// csl_port clock(input);
  ifc_bu ifcbu0;

  ubu(){
  }
};

// pair unit

csl_unit upair{
// csl_port reset(input);
//  csl_port clock(input);
  usu su;
  ubu bu;
  ifc_bu ifcbu1;
  ifc_su ifcsu1;

  upair(){
ifcbu1.connect_by_pattern(ifcbu0);
ifcsu1.connect_by_pattern(ifcsu0);
  }
};

// top unit
csl_unit utop{
  //ports
//  csl_port clk(input);
//  csl_port rst(input);

  // interfaces

  ifc_su ifcsu2;
  ifc_su ifcsu3;
  ifc_bu ifcbu2;
  ifc_bu ifcbu3;

  //unit instances

  upair u0;
  upair u1;
 

  utop(){

    //connecting clock and reset
 //  clk.connect_by_pattern(clock);
 //   rst.connect_by_pattern(reset);

    //connect_by_name by units
   u0.ifcsu1.connect_by_name(ifcsu2);
   u1.ifcsu1.connect_by_name(ifcsu3);
   u0.ifcbu1.connect_by_name(ifcbu2);
   u1.ifcbu1.connect_by_name(ifcbu3);

    
  }
};
